(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[588],{8740:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[appId]/[textbookId]/[textbookPageId]",function(){return n(7730)}])},7730:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSG:function(){return P},default:function(){return O}});var o=n(7568),r=n(655),a=n(5893),s=n(9008),i=n.n(s),c=n(1664),l=n.n(c),d=n(7294),u=n(1997),p=n(1799);function m(e,t,n,o){return h.apply(this,arguments)}function h(){return(h=(0,o.Z)(function(e,t,n,a){var s,i,c,l,d,u;return(0,r.__generator)(this,function(u){switch(u.label){case 0:var p;s=function(){var n,o,s,u,p,m,h,v,f,_;return(0,r.__generator)(this,function(r){switch(r.label){case 0:if(d++>=100)return[2,"break"];if(l.filter(function(t){return t.destination.protocolIndex==e.protocols.length&&"downToUp"==t.destination.direction}).length==l.length&&(l=function(e){if(!Array.isArray(e))throw TypeError(`Expected an array, got ${typeof e}`);e=[...e];for(let t=e.length-1;t>0;t--){let n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}(l)),void 0===(n=l.shift())||""==n.destination.device||(a({type:"executeTask",task:n}),o=n.destination.protocolIndex,c[n.destination.device][n.destination.direction][n.destination.protocolIndex].push(n.data),"downToUp"==n.destination.direction&&n.data.meta.end))return[2,"continue"];return[4,i(100)];case 1:if(r.sent(),"upToDown"==n.destination.direction&&o==e.protocols.length-1)return l.push({data:n.data,destination:{device:"198.51.100.255"==n.data.meta.peersIpAddress?"server":"203.0.113.128"==n.data.meta.peersIpAddress?"smartphone":"",protocolIndex:o,direction:"downToUp"}}),t(Object.assign({},c)),[2,"continue"];if("downToUp"==n.destination.direction&&0==o){var x,g;return"server"==n.destination.device&&l.push((x=n,g="",{data:{type:"paper",body:"/joho1/internet.html"==x.data.meta.pathname?"<html>\n  <head>\n    <title>インターネットの歴史</title>\n  </head>\n  <body>\n    <h1>インターネットの歴史</h1>\n    <p>\n      インターネットで最初に送信されたデータは「L」と「O」の2文字である。「LOGIN」とやり取りする予定であったが、「G」を入力したところでシステムがクラッシュしてしまい、「LO」としか送信できなかったのである。\n    </p>\n  </body>\n</html>":"/joho1/tags.html"==x.data.meta.pathname?"<html>\n  <head>\n    <title>HTMLタグ 早見表</title>\n  </head>\n  <body>\n    <h1>HTMLタグ 早見表</h1>\n    <p>\n      h1タグ：第1レベルの見出し<br />\n      pタグ：段落<br />\n      brタグ：改行\n    </p>\n  </body>\n</html>":"<html>\n  <head>\n    <title>404 Not Found</title>\n  </head>\n  <body>\n    <h1>404 Not Found</h1>\n    <p>\n    ページが見つかりませんでした。\n    </p>\n  </body>\n</html>",meta:{type:"response",myIpAddress:"203.0.113.128",peersIpAddress:x.data.meta.myIpAddress}},destination:{device:"server",protocolIndex:0,direction:"upToDown"}})),t(Object.assign({},c)),[2,"continue"]}s="upToDown"==n.destination.direction?e.protocols[o+1].addHeader(n.data):e.protocols[o].removeHeader(n.data),u={device:n.destination.device,protocolIndex:n.destination.protocolIndex+("upToDown"==n.destination.direction?1:-1),direction:n.destination.direction},p=!0,m=!1,h=void 0;try{for(v=s[Symbol.iterator]();!(p=(f=v.next()).done);p=!0)_=f.value,l.push({data:_,destination:u})}catch(y){m=!0,h=y}finally{try{p||null==v.return||v.return()}finally{if(m)throw h}}return t(Object.assign({},c)),[2]}})},p=(0,o.Z)(function(e){return(0,r.__generator)(this,function(t){return[2,new Promise(function(t){return setTimeout(t,e)})]})}),i=function(e){return p.apply(this,arguments)},c=v(e),l=n,d=0,u.label=1;case 1:if(!(l.length>0))return[3,3];return[5,(0,r.__values)(s())];case 2:if("break"===u.sent())return[3,3];return[3,1];case 3:return t(Object.assign({},c)),[2]}})})).apply(this,arguments)}function v(e){var t=Array(e.protocols.length);return t.fill([]),JSON.parse(JSON.stringify({smartphone:{upToDown:t,downToUp:t},server:{upToDown:t,downToUp:t}}))}var f=n(8277),_=n(3487),x=n.n(_),g=function(e){var t=e.toolConfig,n=e.eventHandler,o=function(e){if("Enter"==e.key&&null!==r.current){r.current.blur();var o=r.current.value.trim();n({type:"enterAddressBar",url:o});try{new URL(o)}catch(a){alert("URL が正しくありません");return}var s=new URL(o);("198.51.100.255"==s.hostname||"example.jp"==s.hostname)&&c(!0),N(v(t)),m(t,N,[{data:{type:"cloud",body:o+" にアクセスしたい",meta:{type:"request",url:o,hostname:s.hostname,pathname:s.pathname,myIpAddress:"203.0.113.128",peersIpAddress:"example.jp"==s.hostname?"198.51.100.255":s.hostname}},destination:{device:"smartphone",protocolIndex:0,direction:"upToDown"}},],n).then(function(){c(!1)})}},r=(0,d.useRef)(null),s=(0,d.useState)(!1),i=s[0],c=s[1],l=(0,d.useState)(!1),u=l[0],p=l[1],h=(0,d.useState)(3),f=h[0],_=h[1],g=(0,d.useState)(v(t)),w=g[0],N=g[1],I=(0,d.useState)(null),k=I[0],C=I[1];return(0,a.jsx)("div",{className:x().tool,children:(0,a.jsxs)("div",{className:x().toolInner,children:[(0,a.jsx)("div",{className:x().spaceForCover,children:u?(0,a.jsxs)("button",{className:x().openCoverButton,type:"button",onClick:function(e){p(!1),n({type:"moveCover",coverPosition:!1})},children:["蓋を",(0,a.jsx)("br",{}),"閉める"]}):(0,a.jsxs)("button",{className:x().openCoverButton,type:"button",onClick:function(e){p(!0),n({type:"moveCover",coverPosition:!0})},children:["蓋を",(0,a.jsx)("br",{}),"開ける"]})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:x().smartphone,children:[(0,a.jsxs)("div",{className:x().smartphoneCover+" "+(u?x().coverOpen:""),children:[(0,a.jsx)("div",{className:x().notch}),(0,a.jsx)("div",{className:x().addressBar,children:(0,a.jsx)("input",{ref:r,onKeyDown:o})}),(0,a.jsx)("div",{className:x().browserbody,children:(0,a.jsx)("iframe",{srcDoc:w.smartphone.downToUp[0].length>0&&"paper"==w.smartphone.downToUp[0][0].type?w.smartphone.downToUp[0][0].body:""})})]}),(0,a.jsx)(y,{toolConfig:t,executedData:w,setMordalState:C,eventHandler:n,device:"smartphone"}),(0,a.jsx)(j,{pipeLayer:f,setPipeLayer:_,eventHandler:n}),(0,a.jsx)("div",{className:x().deviceName,children:"スマートフォン"})]}),(0,a.jsxs)("div",{className:x().server,children:[(0,a.jsxs)("div",{className:x().serverCover+" "+(u?x().coverOpen:""),children:[(0,a.jsx)("div",{className:x().serverLight+" "+(i?x().bright:"")}),(0,a.jsx)("div",{className:x().serverRow}),(0,a.jsx)("div",{className:x().serverRow}),(0,a.jsx)("div",{className:x().serverRow}),(0,a.jsx)("div",{className:x().serverRow})]}),(0,a.jsx)(y,{toolConfig:t,executedData:w,setMordalState:C,eventHandler:n,device:"server"}),(0,a.jsx)(j,{pipeLayer:f,setPipeLayer:_,eventHandler:n}),(0,a.jsx)("div",{className:x().deviceName,children:"Web サーバ"})]})]}),(0,a.jsx)(b,{mordalState:k,setMordalState:C,toolConfig:t,setExecutedData:N,eventHandler:n})]})})};function y(e){for(var t=function(e){var t=n.protocols[e],l=["raw","application","transport","internet","interface"][e],d=o[i].upToDown[e].length>0,u=o[i].downToUp[e].length>0,p=t.upToDownManuallyInsertable,m=0!=e?(0,a.jsx)("div",{className:x().conversionProgram,children:"</>"}):(0,a.jsx)(a.Fragment,{});c.push((0,a.jsxs)("div",{className:x().dataLayer,style:{backgroundColor:t.color},children:[(0,a.jsx)("div",{className:x().dataFrame,children:d?(0,a.jsx)("img",{src:"../../../image/pipe-".concat(l,".svg"),alt:"↑",className:x().dataFrameImage+" "+x().clickable,onClick:function(t){d&&(r({type:"data",ref:o[i].upToDown[e]}),s({type:"openDataPage",device:i,direction:"upToDown",protocolIndex:e}))}}):(0,a.jsx)(a.Fragment,{})}),(0,a.jsxs)("div",{className:x().arrow,children:[(0,a.jsx)("img",{src:"../../../image/arrow.svg",alt:"↓",className:x().arrowImage+" "+(p?x().clickable:""),onClick:function(t){p&&(r({type:"dataIn",ref:{device:i,protocolIndex:e}}),s({type:"openInsertPage",device:i,protocolIndex:e}))}}),m]}),(0,a.jsx)("div",{className:x().protocolName,children:t.name}),(0,a.jsxs)("div",{className:x().arrow,children:[(0,a.jsx)("img",{src:"../../../image/arrow.svg",alt:"↑",className:x().arrowImage,style:{transform:"scale(1,-1)"}}),m]}),(0,a.jsx)("div",{className:x().dataFrame,children:u?(0,a.jsx)("img",{src:"../../../image/pipe-".concat(l,".svg"),alt:"↑",className:x().dataFrameImage+" "+x().clickable,onClick:function(t){u&&(r({type:"data",ref:o[i].downToUp[e]}),s({type:"openDataPage",device:i,direction:"downToUp",protocolIndex:e}))}}):(0,a.jsx)(a.Fragment,{})})]},e))},n=e.toolConfig,o=e.executedData,r=e.setMordalState,s=e.eventHandler,i=e.device,c=[],l=0;l<n.protocols.length;l++)t(l);return(0,a.jsx)("div",{className:x().inner,children:c})}function j(e){var t=e.pipeLayer,n=e.setPipeLayer,o=e.eventHandler;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:x().cloud,style:{height:Math.max(0,3.4+4*(3-t))+"rem"},children:[(0,a.jsx)("div",{className:x().cloudBody}),(0,a.jsxs)("div",{className:x().cloudWave,children:[(0,a.jsx)("div",{}),(0,a.jsx)("div",{}),(0,a.jsx)("div",{}),(0,a.jsx)("div",{}),(0,a.jsx)("div",{}),(0,a.jsx)("div",{})]})]}),(0,a.jsxs)("div",{className:x().pipe,style:{height:Math.max(4.2,3.4+4*t)+"rem"},children:[(0,a.jsx)("button",{type:"button",className:x().buttonDown,onClick:function(e){n(Math.max(0,t-1)),o({type:"movePipe",direction:"down",destination:Math.max(0,t-1)})},children:"↓"}),(0,a.jsx)("button",{type:"button",className:x().buttonUp,onClick:function(e){n(Math.min(4,t+1)),o({type:"movePipe",direction:"up",destination:Math.min(4,t+1)})},children:"↑"})]})]})}function b(e){var t=e.mordalState,n=e.setMordalState,o=e.toolConfig,r=e.setExecutedData,s=e.eventHandler,i=(0,d.useRef)(null),c=(0,d.useRef)(null);if((0,d.useEffect)(function(){null!==i.current&&(i.current.scrollTop=1e7,i.current.scroll({top:0,left:0,behavior:"smooth"}))},[t]),null===t)return(0,a.jsx)(a.Fragment,{});var l="",u=[];if("data"==t.type){l="通過したデータ一覧";var h=!0,v=!1,_=void 0;try{for(var g,y=t.ref[Symbol.iterator]();!(h=(g=y.next()).done);h=!0){var j=g.value;u.push((0,a.jsx)(f.Z,{data:j},JSON.stringify(j)))}}catch(b){v=!0,_=b}finally{try{h||null==y.return||y.return()}finally{if(v)throw _}}}if("dataIn"==t.type){var w=t.ref.protocolIndex;l="データの流し込み",u.push((0,a.jsx)("div",{children:(0,a.jsx)("textarea",{ref:c,style:{width:"100%"},rows:10})},"textarea")),u.push((0,a.jsxs)("button",{onClick:function(e){if(c.current){var a=t.ref.device;s({type:"insertManually",device:a,protocolIndex:w,body:c.current.value}),m(o,r,o.protocols[w].addHeader({type:"paper",body:c.current.value,meta:{}}).map(function(e){var t,n;return{data:(t=(0,p.Z)({},e),n=(n={meta:{end:!0,myIpAddress:"smartphone"==a?"203.0.113.128":"198.51.100.255",peersIpAddress:"smartphone"==a?"198.51.100.255":"203.0.113.128"}},n),Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}),t),destination:{device:a,protocolIndex:w,direction:"upToDown"}}}),s)}n(null)},children:["上の内容を ",o.protocols[w].name," の形式に直して流し込み"]},"button"))}return(0,a.jsx)("div",{className:x().mordalOuter,children:(0,a.jsxs)("div",{className:x().mordal,children:[(0,a.jsxs)("div",{className:x().mordalHead,children:[(0,a.jsx)("h2",{children:l},"h2"),(0,a.jsx)("div",{className:x().mordalClose,onClick:function(e){return n(null)},children:"\xd7"})]}),(0,a.jsx)("div",{className:x().mordalBody,ref:i,children:u})]})})}var w=n(2442),N=n(8788),I=n(593),k=n(4300),C=n.n(k),P=!0,O=function(e){var t=function(e){_.push(e),x(Object.assign([],_)),(0,I.bZ)(e)},n=(0,w.M)(e.appId);if(void 0===n)throw"App ".concat(e.appId," not found");var s=n.textbooks.find(function(t){return t.id==e.textbookId});if(void 0===s)throw"Textbook ".concat(e.textbookId," not found");var c=s.pages.find(function(t){return t.id==e.textbookPageId}),p=s.pages.findIndex(function(t){return t.id==e.textbookPageId});if(void 0===c)throw"TextbookPage ".concat(e.textbookPageId," not found");(0,d.useEffect)(function(){(0,o.Z)(function(){return(0,r.__generator)(this,function(e){return(0,I.Wq)({type:"view"}),[2]})})()},[n,s,c]),(0,d.useEffect)(function(){setInterval((0,o.Z)(function(){return(0,r.__generator)(this,function(e){return(0,I.Wq)({type:"keep"}),[2]})}),1e4)},[]);var m=(0,d.useState)(null),h=m[0],v=m[1];(0,d.useEffect)(function(){(0,o.Z)(function(){return(0,r.__generator)(this,function(e){switch(e.label){case 0:return[4,(0,I.Ms)()];case 1:return v.apply(void 0,[e.sent()]),[2]}})})()},[]);var f=(0,d.useState)([]),_=f[0],x=f[1],y=(0,d.useRef)(null);(0,d.useEffect)(function(){null!==y.current&&(y.current.scrollTop=0)},[c.content]);var j,b=(0,d.useState)({}),k=b[0],P=b[1],O=(j=(0,o.Z)(function(){var e;return(0,r.__generator)(this,function(t){switch(t.label){case 0:var n;return[4,c.goalKeys.reduce((n=(0,o.Z)(function(e,t){var n;return(0,r.__generator)(this,function(o){switch(o.label){case 0:return[4,e];case 1:if(!(n=o.sent()))return[3,3];return[4,N.U2(t)];case 2:n=o.sent(),o.label=3;case 3:return[2,n]}})}),function(e,t){return n.apply(this,arguments)}),Promise.resolve(!0))];case 1:if(!(e=t.sent()))return[3,3];return[4,N.U2("pageCompleted_".concat(c.id))];case 2:e=!0!==t.sent(),t.label=3;case 3:if(!e)return[3,5];return[4,N.t8("pageCompleted_".concat(c.id),!0)];case 4:t.sent(),(0,I.bZ)({type:"completePage",key:"pageCompleted_".concat(c.id)}),t.label=5;case 5:return[2]}})}),function(){return j.apply(this,arguments)});return(0,d.useEffect)(function(){(0,o.Z)(function(){var e,t,n,o,a,i,c,l,d;return(0,r.__generator)(this,function(r){switch(r.label){case 0:return[4,O()];case 1:r.sent(),e={},t=!0,n=!1,o=void 0,r.label=2;case 2:r.trys.push([2,7,8,9]),a=s.pages[Symbol.iterator](),r.label=3;case 3:if(t=(i=a.next()).done)return[3,6];return l=(c=i.value).id,[4,N.U2("pageCompleted_".concat(c.id))];case 4:e[l]=r.sent(),r.label=5;case 5:return t=!0,[3,3];case 6:return[3,9];case 7:return d=r.sent(),n=!0,o=d,[3,9];case 8:try{t||null==a.return||a.return()}finally{if(n)throw o}return[7];case 9:return P(e),[2]}})})()},[c,_]),(0,d.useEffect)(function(){_.length>0&&(_.splice(0,_.length),x([]))},[_]),(0,a.jsxs)("div",{children:[(0,a.jsx)(i(),{children:(0,a.jsx)("title",{children:s.title+" - ProtoSim"})}),(0,a.jsxs)("header",{className:C().header,children:[(0,a.jsx)("a",{href:"../../",children:"通信プロトコルシミュレータ「ProtoSim (プロトシム)」"}),(0,a.jsx)("span",{className:C().userName,children:null==h?"ゲストユーザ":h})]}),(0,a.jsxs)("main",{className:C().main,children:[(0,a.jsx)("div",{className:C().textbookPageListArea,children:(0,a.jsx)("ul",{children:s.pages.map(function(e){return(0,a.jsx)("li",{className:(e.id==c.id?C().openedPage:"")+" "+(!0===k[e.id]?C().completedPage:""),children:(0,a.jsx)(l(),{href:"/".concat(n.id,"/").concat(s.id,"/").concat(e.id),children:(0,a.jsxs)("a",{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("img",{src:"../../../image/book-".concat(e.iconType,".svg")}),!0===k[e.id]?(0,a.jsx)("img",{src:"../../../image/book-check.svg"}):(0,a.jsx)(a.Fragment,{})]}),(0,a.jsx)("div",{children:e.title})]})})},e.id)})})}),(0,a.jsx)("div",{className:C().textbookArea,ref:y,children:(0,a.jsx)(u.ZP,{textbook:s,page:c,prevLink:p-1>=0?"/".concat(n.id,"/").concat(s.id,"/").concat(s.pages[p-1].id):null,nextLink:p+1<s.pages.length?"/".concat(n.id,"/").concat(s.id,"/").concat(s.pages[p+1].id):null,eventHandler:t,toolEvents:_})}),(0,a.jsx)("div",{className:C().toolArea,children:(0,a.jsx)(g,{toolConfig:n.toolConfig,eventHandler:t})})]})]})}},3487:function(e){e.exports={tool:"tool_tool__tA6D4",toolInner:"tool_toolInner__1_puF",openCoverButton:"tool_openCoverButton__bj2xu",spaceForCover:"tool_spaceForCover__NG7eB",coverOpen:"tool_coverOpen__GyXaB",deviceName:"tool_deviceName__KH973",smartphone:"tool_smartphone__PAqCP",smartphoneCover:"tool_smartphoneCover__nWz1d",notch:"tool_notch__KV6BK",addressBar:"tool_addressBar__sHFxI",browserbody:"tool_browserbody__WWBFJ",server:"tool_server__GBUfj",serverCover:"tool_serverCover__fv1xy",serverLight:"tool_serverLight__DEx6J",bright:"tool_bright__xK0Yb",flash:"tool_flash__la7Rk",serverRow:"tool_serverRow___uDt6",inner:"tool_inner__6rOe1",dataLayer:"tool_dataLayer__X9N9u",protocolName:"tool_protocolName__euI89",dataFrame:"tool_dataFrame__Rr0FL",dataFrameImage:"tool_dataFrameImage__bNzUB",arrow:"tool_arrow__7KJRH",arrowImage:"tool_arrowImage__YvIGc",clickable:"tool_clickable__2r_Z_",conversionProgram:"tool_conversionProgram__Yi8eP",pipe:"tool_pipe__OvWPb",cloud:"tool_cloud__Fhi6w",cloudBody:"tool_cloudBody__cuoH3",cloudWave:"tool_cloudWave__ZcEZa",buttonDown:"tool_buttonDown__j7Jip",buttonUp:"tool_buttonUp__o0ylg",mordalOuter:"tool_mordalOuter__imXod",mordal:"tool_mordal__VsqwE",mordalHead:"tool_mordalHead___7ubF",mordalClose:"tool_mordalClose__cha8L",mordalBody:"tool_mordalBody__LEXQ4"}}},function(e){e.O(0,[126,992,774,888,179],function(){return e(e.s=8740)}),_N_E=e.O()}]);